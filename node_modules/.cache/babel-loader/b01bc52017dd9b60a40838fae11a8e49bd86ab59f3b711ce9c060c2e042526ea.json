{"ast":null,"code":"// src/services/newsService.js\nimport apiClient from './apiClient';\nimport { createFileUploadConfig } from './apiClient';\nconst API_BASE_PATH = '/api/v1/news';\nconst newsService = {\n  // Get all news articles\n  getAllNews: async () => {\n    try {\n      const response = await apiClient.get(API_BASE_PATH); // Đổi tên biến thành 'response'\n      // Kiểm tra cấu trúc phản hồi. Nếu API trả về { \"success\": true, \"data\": { \"news\": [...] } }\n      if (response.data && response.data.data && Array.isArray(response.data.data.news)) {\n        return response.data.data.news; // <-- TRẢ VỀ TRỰC TIẾP MẢNG CÁC BÀI VIẾT TIN TỨC\n      } else if (Array.isArray(response.data)) {\n        // Trường hợp API trả về mảng trực tiếp (ít phổ biến hơn)\n        return response.data;\n      } else {\n        // Log lỗi nếu cấu trúc không như mong đợi\n        console.error(\"Unexpected API response structure for getAllNews:\", response.data);\n        return []; // Trả về mảng rỗng để tránh lỗi khi render\n      }\n    } catch (error) {\n      console.error(\"Error fetching all news:\", error);\n      throw error;\n    }\n  },\n  // Get news by ID\n  getNewsById: async id => {\n    try {\n      const response = await apiClient.get(`${API_BASE_PATH}/${id}`);\n      // Giả định API chi tiết cũng trả về trong thuộc tính 'data'\n      return response.data.data || response.data; // Lấy data.data hoặc data\n    } catch (error) {\n      console.error(`Error fetching news with ID ${id}:`, error);\n      throw error;\n    }\n  },\n  createNews: async newsData => {\n    try {\n      const response = await apiClient.post(API_BASE_PATH, newsData);\n      return response.data; // Trả về data của response, nơi chứa thông tin thành công/đối tượng mới\n    } catch (error) {\n      console.error(\"Error creating news:\", error);\n      throw error;\n    }\n  },\n  // Update a news article\n  updateNews: async (id, newsData) => {\n    try {\n      const response = await apiClient.put(`${API_BASE_PATH}/${id}`, newsData);\n      return response.data; // Trả về data của response\n    } catch (error) {\n      console.error(`Error updating news with ID ${id}:`, error);\n      throw error;\n    }\n  },\n  // Delete a news article\n  deleteNews: async id => {\n    try {\n      const response = await apiClient.delete(`${API_BASE_PATH}/${id}`);\n      return response.data; // Trả về data của response (ví dụ: thông báo xóa thành công)\n    } catch (error) {\n      console.error(`Error deleting news with ID ${id}:`, error);\n      throw error;\n    }\n  },\n  uploadNewsAttachments: async (newsId, file, onUploadProgress) => {\n    try {\n      const formData = new FormData();\n      formData.append('files', file);\n      const config = createFileUploadConfig(onUploadProgress);\n      const response = await apiClient.post(`${API_BASE_PATH}/uploads/${newsId}`, formData, config);\n      return response.data; // Trả về data của response\n    } catch (error) {\n      console.error(`Error uploading attachment for news ID ${newsId}:`, error);\n      throw error;\n    }\n  },\n  getImageUrl: imageName => {\n    // Đảm bảo REACT_APP_API_URL được cấu hình đúng trong .env\n    return `${process.env.REACT_APP_API_URL || 'http://localhost:8080'}${API_BASE_PATH}/image/${imageName}`;\n  }\n};\nexport default newsService;","map":{"version":3,"names":["apiClient","createFileUploadConfig","API_BASE_PATH","newsService","getAllNews","response","get","data","Array","isArray","news","console","error","getNewsById","id","createNews","newsData","post","updateNews","put","deleteNews","delete","uploadNewsAttachments","newsId","file","onUploadProgress","formData","FormData","append","config","getImageUrl","imageName","process","env","REACT_APP_API_URL"],"sources":["/Users/lucas/Desktop/an/fe-edu/src/services/newsService.js"],"sourcesContent":["// src/services/newsService.js\nimport apiClient from './apiClient';\nimport { createFileUploadConfig } from './apiClient';\n\nconst API_BASE_PATH = '/api/v1/news';\n\nconst newsService = {\n  // Get all news articles\n  getAllNews: async () => {\n    try {\n      const response = await apiClient.get(API_BASE_PATH); // Đổi tên biến thành 'response'\n      // Kiểm tra cấu trúc phản hồi. Nếu API trả về { \"success\": true, \"data\": { \"news\": [...] } }\n      if (response.data && response.data.data && Array.isArray(response.data.data.news)) {\n        return response.data.data.news; // <-- TRẢ VỀ TRỰC TIẾP MẢNG CÁC BÀI VIẾT TIN TỨC\n      } else if (Array.isArray(response.data)) {\n        // Trường hợp API trả về mảng trực tiếp (ít phổ biến hơn)\n        return response.data;\n      } else {\n        // Log lỗi nếu cấu trúc không như mong đợi\n        console.error(\"Unexpected API response structure for getAllNews:\", response.data);\n        return []; // Trả về mảng rỗng để tránh lỗi khi render\n      }\n    } catch (error) {\n      console.error(\"Error fetching all news:\", error);\n      throw error;\n    }\n  },\n\n  // Get news by ID\n  getNewsById: async (id) => {\n    try {\n      const response = await apiClient.get(`${API_BASE_PATH}/${id}`);\n      // Giả định API chi tiết cũng trả về trong thuộc tính 'data'\n      return response.data.data || response.data; // Lấy data.data hoặc data\n    } catch (error) {\n      console.error(`Error fetching news with ID ${id}:`, error);\n      throw error;\n    }\n  },\n\n  createNews: async (newsData) => {\n    try {\n      const response = await apiClient.post(API_BASE_PATH, newsData);\n      return response.data; // Trả về data của response, nơi chứa thông tin thành công/đối tượng mới\n    } catch (error) {\n      console.error(\"Error creating news:\", error);\n      throw error;\n    }\n  },\n\n  // Update a news article\n  updateNews: async (id, newsData) => {\n    try {\n      const response = await apiClient.put(`${API_BASE_PATH}/${id}`, newsData);\n      return response.data; // Trả về data của response\n    } catch (error) {\n      console.error(`Error updating news with ID ${id}:`, error);\n      throw error;\n    }\n  },\n\n  // Delete a news article\n  deleteNews: async (id) => {\n    try {\n      const response = await apiClient.delete(`${API_BASE_PATH}/${id}`);\n      return response.data; // Trả về data của response (ví dụ: thông báo xóa thành công)\n    } catch (error) {\n      console.error(`Error deleting news with ID ${id}:`, error);\n      throw error;\n    }\n  },\n\n  uploadNewsAttachments: async (newsId, file, onUploadProgress) => {\n    try {\n      const formData = new FormData();\n      formData.append('files', file);\n\n      const config = createFileUploadConfig(onUploadProgress);\n      const response = await apiClient.post(`${API_BASE_PATH}/uploads/${newsId}`, formData, config);\n      return response.data; // Trả về data của response\n    } catch (error) {\n      console.error(`Error uploading attachment for news ID ${newsId}:`, error);\n      throw error;\n    }\n  },\n\n  getImageUrl: (imageName) => {\n    // Đảm bảo REACT_APP_API_URL được cấu hình đúng trong .env\n    return `${process.env.REACT_APP_API_URL || 'http://localhost:8080'}${API_BASE_PATH}/image/${imageName}`;\n  }\n};\n\nexport default newsService;"],"mappings":"AAAA;AACA,OAAOA,SAAS,MAAM,aAAa;AACnC,SAASC,sBAAsB,QAAQ,aAAa;AAEpD,MAAMC,aAAa,GAAG,cAAc;AAEpC,MAAMC,WAAW,GAAG;EAClB;EACAC,UAAU,EAAE,MAAAA,CAAA,KAAY;IACtB,IAAI;MACF,MAAMC,QAAQ,GAAG,MAAML,SAAS,CAACM,GAAG,CAACJ,aAAa,CAAC,CAAC,CAAC;MACrD;MACA,IAAIG,QAAQ,CAACE,IAAI,IAAIF,QAAQ,CAACE,IAAI,CAACA,IAAI,IAAIC,KAAK,CAACC,OAAO,CAACJ,QAAQ,CAACE,IAAI,CAACA,IAAI,CAACG,IAAI,CAAC,EAAE;QACjF,OAAOL,QAAQ,CAACE,IAAI,CAACA,IAAI,CAACG,IAAI,CAAC,CAAC;MAClC,CAAC,MAAM,IAAIF,KAAK,CAACC,OAAO,CAACJ,QAAQ,CAACE,IAAI,CAAC,EAAE;QACvC;QACA,OAAOF,QAAQ,CAACE,IAAI;MACtB,CAAC,MAAM;QACL;QACAI,OAAO,CAACC,KAAK,CAAC,mDAAmD,EAAEP,QAAQ,CAACE,IAAI,CAAC;QACjF,OAAO,EAAE,CAAC,CAAC;MACb;IACF,CAAC,CAAC,OAAOK,KAAK,EAAE;MACdD,OAAO,CAACC,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAAC;MAChD,MAAMA,KAAK;IACb;EACF,CAAC;EAED;EACAC,WAAW,EAAE,MAAOC,EAAE,IAAK;IACzB,IAAI;MACF,MAAMT,QAAQ,GAAG,MAAML,SAAS,CAACM,GAAG,CAAC,GAAGJ,aAAa,IAAIY,EAAE,EAAE,CAAC;MAC9D;MACA,OAAOT,QAAQ,CAACE,IAAI,CAACA,IAAI,IAAIF,QAAQ,CAACE,IAAI,CAAC,CAAC;IAC9C,CAAC,CAAC,OAAOK,KAAK,EAAE;MACdD,OAAO,CAACC,KAAK,CAAC,+BAA+BE,EAAE,GAAG,EAAEF,KAAK,CAAC;MAC1D,MAAMA,KAAK;IACb;EACF,CAAC;EAEDG,UAAU,EAAE,MAAOC,QAAQ,IAAK;IAC9B,IAAI;MACF,MAAMX,QAAQ,GAAG,MAAML,SAAS,CAACiB,IAAI,CAACf,aAAa,EAAEc,QAAQ,CAAC;MAC9D,OAAOX,QAAQ,CAACE,IAAI,CAAC,CAAC;IACxB,CAAC,CAAC,OAAOK,KAAK,EAAE;MACdD,OAAO,CAACC,KAAK,CAAC,sBAAsB,EAAEA,KAAK,CAAC;MAC5C,MAAMA,KAAK;IACb;EACF,CAAC;EAED;EACAM,UAAU,EAAE,MAAAA,CAAOJ,EAAE,EAAEE,QAAQ,KAAK;IAClC,IAAI;MACF,MAAMX,QAAQ,GAAG,MAAML,SAAS,CAACmB,GAAG,CAAC,GAAGjB,aAAa,IAAIY,EAAE,EAAE,EAAEE,QAAQ,CAAC;MACxE,OAAOX,QAAQ,CAACE,IAAI,CAAC,CAAC;IACxB,CAAC,CAAC,OAAOK,KAAK,EAAE;MACdD,OAAO,CAACC,KAAK,CAAC,+BAA+BE,EAAE,GAAG,EAAEF,KAAK,CAAC;MAC1D,MAAMA,KAAK;IACb;EACF,CAAC;EAED;EACAQ,UAAU,EAAE,MAAON,EAAE,IAAK;IACxB,IAAI;MACF,MAAMT,QAAQ,GAAG,MAAML,SAAS,CAACqB,MAAM,CAAC,GAAGnB,aAAa,IAAIY,EAAE,EAAE,CAAC;MACjE,OAAOT,QAAQ,CAACE,IAAI,CAAC,CAAC;IACxB,CAAC,CAAC,OAAOK,KAAK,EAAE;MACdD,OAAO,CAACC,KAAK,CAAC,+BAA+BE,EAAE,GAAG,EAAEF,KAAK,CAAC;MAC1D,MAAMA,KAAK;IACb;EACF,CAAC;EAEDU,qBAAqB,EAAE,MAAAA,CAAOC,MAAM,EAAEC,IAAI,EAAEC,gBAAgB,KAAK;IAC/D,IAAI;MACF,MAAMC,QAAQ,GAAG,IAAIC,QAAQ,CAAC,CAAC;MAC/BD,QAAQ,CAACE,MAAM,CAAC,OAAO,EAAEJ,IAAI,CAAC;MAE9B,MAAMK,MAAM,GAAG5B,sBAAsB,CAACwB,gBAAgB,CAAC;MACvD,MAAMpB,QAAQ,GAAG,MAAML,SAAS,CAACiB,IAAI,CAAC,GAAGf,aAAa,YAAYqB,MAAM,EAAE,EAAEG,QAAQ,EAAEG,MAAM,CAAC;MAC7F,OAAOxB,QAAQ,CAACE,IAAI,CAAC,CAAC;IACxB,CAAC,CAAC,OAAOK,KAAK,EAAE;MACdD,OAAO,CAACC,KAAK,CAAC,0CAA0CW,MAAM,GAAG,EAAEX,KAAK,CAAC;MACzE,MAAMA,KAAK;IACb;EACF,CAAC;EAEDkB,WAAW,EAAGC,SAAS,IAAK;IAC1B;IACA,OAAO,GAAGC,OAAO,CAACC,GAAG,CAACC,iBAAiB,IAAI,uBAAuB,GAAGhC,aAAa,UAAU6B,SAAS,EAAE;EACzG;AACF,CAAC;AAED,eAAe5B,WAAW","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}