{"ast":null,"code":"// src/services/newsService.js\nimport apiClient from './apiClient';\nimport { createFileUploadConfig } from './apiClient';\nconst API_BASE_PATH = '/api/v1/news';\nconst newsService = {\n  // Các hàm này giữ nguyên logic bạn cung cấp (trả về response.data)\n  // và nếu chúng đang chạy tốt, không cần sửa đổi thêm.\n  getAllNews: async () => {\n    try {\n      const response = await apiClient.get(API_BASE_PATH);\n      return response.data;\n    } catch (error) {\n      var _error$response, _error$response$data;\n      console.error(\"Error fetching all news:\", error);\n      throw new Error(`Failed to fetch news: ${((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || error.message}`);\n    }\n  },\n  getNewsById: async id => {\n    try {\n      const response = await apiClient.get(`${API_BASE_PATH}/${id}`);\n      return response.data;\n    } catch (error) {\n      var _error$response2, _error$response2$data;\n      console.error(`Error fetching news with ID ${id}:`, error);\n      throw new Error(`Failed to fetch news with ID ${id}: ${((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.message) || error.message}`);\n    }\n  },\n  createNews: async newsData => {\n    try {\n      const response = await apiClient.post(API_BASE_PATH, newsData);\n      return response.data;\n    } catch (error) {\n      var _error$response3, _error$response3$data;\n      console.error(\"Error creating news:\", error);\n      throw new Error(`Failed to create news: ${((_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : (_error$response3$data = _error$response3.data) === null || _error$response3$data === void 0 ? void 0 : _error$response3$data.message) || error.message}`);\n    }\n  },\n  updateNews: async (id, newsData) => {\n    try {\n      const response = await apiClient.put(`${API_BASE_PATH}/${id}`, newsData);\n      return response.data;\n    } catch (error) {\n      var _error$response4, _error$response4$data;\n      console.error(`Error updating news with ID ${id}:`, error);\n      throw new Error(`Failed to update news with ID ${id}: ${((_error$response4 = error.response) === null || _error$response4 === void 0 ? void 0 : (_error$response4$data = _error$response4.data) === null || _error$response4$data === void 0 ? void 0 : _error$response4$data.message) || error.message}`);\n    }\n  },\n  deleteNews: async id => {\n    try {\n      const response = await apiClient.delete(`${API_BASE_PATH}/${id}`);\n      return response.data;\n    } catch (error) {\n      var _error$response5, _error$response5$data;\n      console.error(`Error deleting news with ID ${id}:`, error);\n      throw new Error(`Failed to delete news with ID ${id}: ${((_error$response5 = error.response) === null || _error$response5 === void 0 ? void 0 : (_error$response5$data = _error$response5.data) === null || _error$response5$data === void 0 ? void 0 : _error$response5$data.message) || error.message}`);\n    }\n  },\n  // SỬA ĐỔI DUY NHẤT Ở ĐÂY ĐỂ XỬ LÝ NHIỀU FILE\n  uploadNewsAttachments: async (newsId, files, onUploadProgress) => {\n    // Thay 'file' thành 'files' (số nhiều)\n    try {\n      const formData = new FormData();\n      // Lặp qua từng file trong mảng 'files' và thêm vào formData\n      files.forEach(file => {\n        formData.append('files', file); // Tên trường 'files' phải khớp với @RequestParam(\"files\") ở Backend\n      });\n\n      // createFileUploadConfig có thể thêm onUploadProgress và các headers khác.\n      // Axios sẽ tự động đặt Content-Type: multipart/form-data.\n      const config = createFileUploadConfig(onUploadProgress);\n      const response = await apiClient.post(`${API_BASE_PATH}/uploads/${newsId}`, formData, config);\n      return response.data; // Trả về data của response\n    } catch (error) {\n      var _error$response6, _error$response6$data;\n      console.error(`Error uploading attachments for news ID ${newsId}:`, error); // Đổi \"attachment\" thành \"attachments\"\n      throw new Error(`Failed to upload attachments for news ID ${newsId}: ${((_error$response6 = error.response) === null || _error$response6 === void 0 ? void 0 : (_error$response6$data = _error$response6.data) === null || _error$response6$data === void 0 ? void 0 : _error$response6$data.message) || error.message}`);\n    }\n  },\n  getImageUrl: imageName => {\n    return `${process.env.REACT_APP_API_URL || 'http://localhost:8080'}${API_BASE_PATH}/image/${imageName}`;\n  }\n};\nexport default newsService;","map":{"version":3,"names":["apiClient","createFileUploadConfig","API_BASE_PATH","newsService","getAllNews","response","get","data","error","_error$response","_error$response$data","console","Error","message","getNewsById","id","_error$response2","_error$response2$data","createNews","newsData","post","_error$response3","_error$response3$data","updateNews","put","_error$response4","_error$response4$data","deleteNews","delete","_error$response5","_error$response5$data","uploadNewsAttachments","newsId","files","onUploadProgress","formData","FormData","forEach","file","append","config","_error$response6","_error$response6$data","getImageUrl","imageName","process","env","REACT_APP_API_URL"],"sources":["/Users/lucas/Desktop/an/fe-edu/src/services/newsService.js"],"sourcesContent":["// src/services/newsService.js\nimport apiClient from './apiClient';\nimport { createFileUploadConfig } from './apiClient';\n\nconst API_BASE_PATH = '/api/v1/news';\n\nconst newsService = {\n  // Các hàm này giữ nguyên logic bạn cung cấp (trả về response.data)\n  // và nếu chúng đang chạy tốt, không cần sửa đổi thêm.\n  getAllNews: async () => {\n    try {\n      const response = await apiClient.get(API_BASE_PATH);\n      return response.data;\n    } catch (error) {\n      console.error(\"Error fetching all news:\", error);\n      throw new Error(`Failed to fetch news: ${error.response?.data?.message || error.message}`);\n    }\n  },\n\n  getNewsById: async (id) => {\n    try {\n      const response = await apiClient.get(`${API_BASE_PATH}/${id}`);\n      return response.data;\n    } catch (error) {\n      console.error(`Error fetching news with ID ${id}:`, error);\n      throw new Error(`Failed to fetch news with ID ${id}: ${error.response?.data?.message || error.message}`);\n    }\n  },\n\n  createNews: async (newsData) => {\n    try {\n      const response = await apiClient.post(API_BASE_PATH, newsData);\n      return response.data;\n    } catch (error) {\n      console.error(\"Error creating news:\", error);\n      throw new Error(`Failed to create news: ${error.response?.data?.message || error.message}`);\n    }\n  },\n\n  updateNews: async (id, newsData) => {\n    try {\n      const response = await apiClient.put(`${API_BASE_PATH}/${id}`, newsData);\n      return response.data;\n    } catch (error) {\n      console.error(`Error updating news with ID ${id}:`, error);\n      throw new Error(`Failed to update news with ID ${id}: ${error.response?.data?.message || error.message}`);\n    }\n  },\n\n  deleteNews: async (id) => {\n    try {\n      const response = await apiClient.delete(`${API_BASE_PATH}/${id}`);\n      return response.data;\n    } catch (error) {\n      console.error(`Error deleting news with ID ${id}:`, error);\n      throw new Error(`Failed to delete news with ID ${id}: ${error.response?.data?.message || error.message}`);\n    }\n  },\n\n  // SỬA ĐỔI DUY NHẤT Ở ĐÂY ĐỂ XỬ LÝ NHIỀU FILE\n  uploadNewsAttachments: async (newsId, files, onUploadProgress) => { // Thay 'file' thành 'files' (số nhiều)\n    try {\n      const formData = new FormData();\n      // Lặp qua từng file trong mảng 'files' và thêm vào formData\n      files.forEach(file => {\n        formData.append('files', file); // Tên trường 'files' phải khớp với @RequestParam(\"files\") ở Backend\n      });\n\n      // createFileUploadConfig có thể thêm onUploadProgress và các headers khác.\n      // Axios sẽ tự động đặt Content-Type: multipart/form-data.\n      const config = createFileUploadConfig(onUploadProgress);\n\n      const response = await apiClient.post(`${API_BASE_PATH}/uploads/${newsId}`, formData, config);\n      return response.data; // Trả về data của response\n    } catch (error) {\n      console.error(`Error uploading attachments for news ID ${newsId}:`, error); // Đổi \"attachment\" thành \"attachments\"\n      throw new Error(`Failed to upload attachments for news ID ${newsId}: ${error.response?.data?.message || error.message}`);\n    }\n  },\n\n  getImageUrl: (imageName) => {\n    return `${process.env.REACT_APP_API_URL || 'http://localhost:8080'}${API_BASE_PATH}/image/${imageName}`;\n  }\n};\n\nexport default newsService;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}